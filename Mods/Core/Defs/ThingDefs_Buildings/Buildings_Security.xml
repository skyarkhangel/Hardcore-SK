<?xml version="1.0" encoding="utf-8" ?>
<Defs>

  <ThingDef ParentName="BuildingBase">
    <defName>Sandbags</defName>
    <label>sandbags</label>
    <description>Bags of locally-sourced dirt or sand held in place by steel rods. Sandbags are ugly, but provide excellent cover from ranged attacks.</description>
    <thingClass>Building</thingClass>
    <category>Building</category>
    <graphicData>
      <texPath>Things/Building/Linked/Sandbags_Atlas</texPath>
      <graphicClass>Graphic_Single</graphicClass>
      <linkType>Basic</linkType>
      <linkFlags>
        <li>Sandbags</li>
      </linkFlags>
      <color>(139,122,87)</color>
    </graphicData>
    <uiIconPath>Things/Building/Linked/Sandbags_MenuIcon</uiIconPath>
    <uiIconColor>(139,122,87)</uiIconColor>
    <altitudeLayer>Building</altitudeLayer>
    <pathCost>40</pathCost>
    <pathCostIgnoreRepeat>true</pathCostIgnoreRepeat>
    <passability>PassThroughOnly</passability>
    <castEdgeShadows>true</castEdgeShadows>
    <fillPercent>0.65</fillPercent>
    <canOverlapZones>false</canOverlapZones>
    <statBases>
      <MaxHitPoints>450</MaxHitPoints>
      <Beauty>-10</Beauty>
      <WorkToBuild>120</WorkToBuild>
      <Flammability>0</Flammability>
    </statBases>
    <building>
			<ai_chillDestination>false</ai_chillDestination>
			<isInert>true</isInert>
      <blueprintGraphicData>
        <texPath>Things/Building/Linked/Sandbags_Blueprint_Atlas</texPath>
      </blueprintGraphicData>
    </building>
    <placingDraggableDimensions>1</placingDraggableDimensions>
    <costList>
      <Steel>5</Steel>
    </costList>
    <filthLeaving>SandbagRubble</filthLeaving>
    <rotatable>false</rotatable>
    <selectable>true</selectable>
    <neverMultiSelect>true</neverMultiSelect>
    <terrainAffordanceNeeded>Light</terrainAffordanceNeeded>
    <designationCategory>Security</designationCategory>
    <staticSunShadowHeight>0.20</staticSunShadowHeight>
    <constructEffect>ConstructDirt</constructEffect>
    <repairEffect>ConstructDirt</repairEffect>
    <designationHotKey>Misc1</designationHotKey>
  </ThingDef>

  <!--=============== Mini-turret ===============-->
  
  <ThingDef ParentName="BuildingBase">
    <defName>Turret_MiniTurret</defName>
    <label>mini-turret</label>
    <description>A portable automatic turret. Requires steel to refurbish its barrel after heavy use. May explode when damaged. Its dumb AI brain can't be directly controlled, so beware of friendly fire.</description>
    <thingClass>Building_TurretGun</thingClass>
    <graphicData>
      <texPath>Things/Building/Security/TurretMini_Base</texPath>
      <graphicClass>Graphic_Single</graphicClass>
      <drawSize>(3,3)</drawSize>
      <damageData>
        <rect>(0.2,0.2,0.6,0.6)</rect>
      </damageData>
      <shadowData>
        <volume>(0.27,0.25,0.27)</volume>
        <offset>(0,0,0)</offset>
      </shadowData>
    </graphicData>
    <uiIconPath>Things/Building/Security/TurretMini_MenuIcon</uiIconPath>
    <uiIconScale>0.90</uiIconScale>
    <minifiedDef>MinifiedThing</minifiedDef>
    <altitudeLayer>Building</altitudeLayer>
    <stealable>false</stealable>
    <rotatable>false</rotatable>
    <thingCategories>
      <li>BuildingsSecurity</li>
    </thingCategories>
    <statBases>
      <MaxHitPoints>120</MaxHitPoints>
      <Flammability>0.7</Flammability>
      <WorkToBuild>2000</WorkToBuild>
      <Mass>10</Mass>
      <Beauty>-20</Beauty>
      <ShootingAccuracyTurret>0.96</ShootingAccuracyTurret>
    </statBases>
    <tickerType>Normal</tickerType>
    <comps>
      <li Class="CompProperties_Explosive">
        <explosiveRadius>3.9</explosiveRadius>
        <explosiveDamageType>Bomb</explosiveDamageType>
        <chanceNeverExplodeFromDamage>0.5</chanceNeverExplodeFromDamage>
      </li>
      <li Class="CompProperties_Forbiddable"/>
      <li Class="CompProperties_Power">
        <compClass>CompPowerTrader</compClass>
        <basePowerConsumption>80</basePowerConsumption>
      </li>
      <li Class="CompProperties_Flickable"/>
      <li Class="CompProperties_Breakdownable"/>
      <li Class="CompProperties_Refuelable">
        <fuelLabel>Shots until barrel change</fuelLabel>
        <fuelGizmoLabel>Barrel durability</fuelGizmoLabel>
        <fuelFilter>
          <thingDefs>
            <li>Steel</li>
          </thingDefs>
        </fuelFilter>
        <fuelCapacity>120</fuelCapacity>
        <initialFuelPercent>1</initialFuelPercent>
        <autoRefuelPercent>0.75</autoRefuelPercent>
        <showFuelGizmo>true</showFuelGizmo>
        <minimumFueledThreshold>1</minimumFueledThreshold>
        <fuelMultiplier>3</fuelMultiplier>
        <factorByDifficulty>true</factorByDifficulty>
        <consumeFuelOnlyWhenUsed>true</consumeFuelOnlyWhenUsed>
        <outOfFuelMessage>Cannot shoot: Needs new barrel</outOfFuelMessage>
        <fuelIconPath>UI/Overlays/Barrel</fuelIconPath>
      </li>
    </comps>
    <passability>PassThroughOnly</passability>
    <pathCost>50</pathCost>
    <fillPercent>0.4</fillPercent>
    <hasTooltip>true</hasTooltip>
    <stuffCategories>
      <li>Metallic</li>
    </stuffCategories>
    <costStuffCount>60</costStuffCount>
    <costList>
      <Steel>40</Steel>
      <ComponentIndustrial>3</ComponentIndustrial>
    </costList>
    <terrainAffordanceNeeded>Light</terrainAffordanceNeeded>
    <designationCategory>Security</designationCategory>
    <specialDisplayRadius>24.9</specialDisplayRadius>
    <constructionSkillPrerequisite>5</constructionSkillPrerequisite>
    <building>
			<ai_combatDangerous>true</ai_combatDangerous>
      <turretGunDef>Gun_MiniTurret</turretGunDef>
      <turretBurstCooldownTime>4.8</turretBurstCooldownTime>
      <turretTopGraphicPath>Things/Building/Security/TurretMini_Top</turretTopGraphicPath>
    </building>
    <placeWorkers>
      <li>PlaceWorker_TurretTop</li>
    </placeWorkers>
    <designationHotKey>Misc2</designationHotKey>
    <researchPrerequisites>
      <li>GunTurrets</li>
    </researchPrerequisites>
  </ThingDef>

  <ThingDef ParentName="BaseBullet">
    <defName>Bullet_MiniTurret</defName>
    <label>mini-turret bullet</label>
    <graphicData>
      <texPath>Things/Projectile/Bullet_Small</texPath>
      <graphicClass>Graphic_Single</graphicClass>
    </graphicData>
    <projectile>
      <damageDef>Bullet</damageDef>
      <damageAmountBase>10</damageAmountBase>
      <speed>70</speed>
    </projectile>
  </ThingDef>

  <ThingDef ParentName="BaseHumanGun">
    <defName>Gun_MiniTurret</defName>
    <label>mini-turret gun</label>
    <description>A simple automatic gun made to be mounted on a turret.</description>
    <graphicData>
      <texPath>Things/Item/Equipment/WeaponRanged/ChargeRifle</texPath>
      <graphicClass>Graphic_Single</graphicClass>
    </graphicData>
    <soundInteract>Interact_Rifle</soundInteract>
    <menuHidden>true</menuHidden>
    <destroyOnDrop>true</destroyOnDrop>
    <tradeability>None</tradeability>
    <useHitPoints>false</useHitPoints>
    <statBases>
      <AccuracyTouch>0.70</AccuracyTouch>
      <AccuracyShort>0.64</AccuracyShort>
      <AccuracyMedium>0.41</AccuracyMedium>
      <AccuracyLong>0.22</AccuracyLong>
      <RangedWeapon_Cooldown>4.8</RangedWeapon_Cooldown>
      <DeteriorationRate>0</DeteriorationRate>
      <Mass>5</Mass>
      <Flammability>0</Flammability>
    </statBases>
    <weaponTags Inherit="false">
      <li>TurretGun</li>
    </weaponTags>
    <verbs>
      <li>
        <verbClass>Verb_Shoot</verbClass>
        <hasStandardCommand>true</hasStandardCommand>
        <defaultProjectile>Bullet_MiniTurret</defaultProjectile>
        <warmupTime>0</warmupTime>
        <range>24.9</range>
        <ticksBetweenBurstShots>8</ticksBetweenBurstShots>
        <burstShotCount>3</burstShotCount>
        <soundCast>GunShotA</soundCast>
        <soundCastTail>GunTail_Light</soundCastTail>
        <muzzleFlashScale>9</muzzleFlashScale>
        <consumeFuelPerShot>1</consumeFuelPerShot>
      </li>
    </verbs>
  </ThingDef>

  <!--=============== Autocannon turret ===============-->

  <ThingDef ParentName="BuildingBase" Name="AutocannonTurret">
    <defName>Turret_Autocannon</defName>
    <label>autocannon turret</label>
    <description>A heavy automatic turret. Its large-caliber shells do heavy damage over significant ranges, but its barrel must be refurbished after use. It cannot fire at close-up targets, and may explode when damaged.</description>
    <thingClass>Building_TurretGun</thingClass>
    <graphicData>
      <texPath>Things/Building/Security/TurretAutocannon_Base</texPath>
      <graphicClass>Graphic_Single</graphicClass>
      <drawSize>(1.5, 1.5)</drawSize>
      <damageData>
        <rect>(0.2,0.2,0.6,0.6)</rect>
      </damageData>
      <shadowData>
        <volume>(1.5,0.35,1.4)</volume>
        <offset>(0,0,-0.05)</offset>
      </shadowData>
    </graphicData>
    <uiIconPath>Things/Building/Security/TurretAutocannon_MenuIcon</uiIconPath>
    <altitudeLayer>Building</altitudeLayer>
    <stealable>false</stealable>
    <rotatable>false</rotatable>
    <size>(2,2)</size>
    <statBases>
      <MaxHitPoints>450</MaxHitPoints>
      <Flammability>0.7</Flammability>
      <WorkToBuild>8000</WorkToBuild>
      <Mass>100</Mass>
      <Beauty>-20</Beauty>
      <ShootingAccuracyTurret>0.96</ShootingAccuracyTurret>
    </statBases>
    <tickerType>Normal</tickerType>
    <comps>
      <li Class="CompProperties_Explosive">
        <explosiveRadius>5.9</explosiveRadius>
        <explosiveDamageType>Bomb</explosiveDamageType>
        <chanceNeverExplodeFromDamage>0.5</chanceNeverExplodeFromDamage>
      </li>
      <li Class="CompProperties_Forbiddable"/>
      <li Class="CompProperties_Power">
        <compClass>CompPowerTrader</compClass>
        <basePowerConsumption>150</basePowerConsumption>
      </li>
      <li Class="CompProperties_Flickable"/>
      <li Class="CompProperties_Breakdownable"/>
      <li Class="CompProperties_Refuelable">
        <fuelLabel>Shots until barrel change</fuelLabel>
        <fuelGizmoLabel>Barrel durability</fuelGizmoLabel>
        <fuelFilter>
          <thingDefs>
            <li>Steel</li>
          </thingDefs>
        </fuelFilter>
        <fuelCapacity>90</fuelCapacity>
        <initialFuelPercent>1</initialFuelPercent>
        <autoRefuelPercent>0.75</autoRefuelPercent>
        <showFuelGizmo>true</showFuelGizmo>
        <minimumFueledThreshold>1</minimumFueledThreshold>
        <fuelMultiplier>0.75</fuelMultiplier>
        <factorByDifficulty>true</factorByDifficulty>
        <consumeFuelOnlyWhenUsed>true</consumeFuelOnlyWhenUsed>
        <outOfFuelMessage>Cannot shoot: Needs new barrel</outOfFuelMessage>
        <fuelIconPath>UI/Overlays/Barrel</fuelIconPath>
      </li>
    </comps>
    <passability>PassThroughOnly</passability>
    <pathCost>50</pathCost>
    <fillPercent>0.5</fillPercent>
    <hasTooltip>true</hasTooltip>
    <costList>
      <Steel>350</Steel>
      <Plasteel>40</Plasteel>
      <ComponentIndustrial>6</ComponentIndustrial>
    </costList>
    <terrainAffordanceNeeded>Heavy</terrainAffordanceNeeded>
    <designationCategory>Security</designationCategory>
    <specialDisplayRadius>32.9</specialDisplayRadius>
    <constructionSkillPrerequisite>6</constructionSkillPrerequisite>
    <building>
      <ai_combatDangerous>true</ai_combatDangerous>
      <turretGunDef>Gun_AutocannonTurret</turretGunDef>
      <turretBurstCooldownTime>3.5</turretBurstCooldownTime>
      <turretTopGraphicPath>Things/Building/Security/TurretAutocannon_Top</turretTopGraphicPath>
      <turretTopDrawSize>2.7</turretTopDrawSize>
      <turretTopOffset>(0, 0.05)</turretTopOffset>
    </building>
    <placeWorkers>
      <li>PlaceWorker_TurretTop</li>
    </placeWorkers>
    <designationHotKey>Misc3</designationHotKey>
    <researchPrerequisites>
      <li>HeavyTurrets</li>
    </researchPrerequisites>
    <uiIconScale>0.95</uiIconScale>
  </ThingDef>

  <ThingDef ParentName="BaseBullet">
    <defName>Bullet_AutocannonTurret</defName>
    <label>autocannon shell</label>
    <graphicData>
      <texPath>Things/Projectile/Bullet_Big</texPath>
      <graphicClass>Graphic_Single</graphicClass>
    </graphicData>
    <projectile>
      <damageDef>Bullet</damageDef>
      <damageAmountBase>40</damageAmountBase>
      <speed>88</speed>
    </projectile>
  </ThingDef>

  <ThingDef ParentName="BaseHumanGun">
    <defName>Gun_AutocannonTurret</defName>
    <label>autocannon</label>
    <description>A self-loading large-bore cannon designed to attach to a turret.</description>
    <graphicData>
      <texPath>Things/Item/Equipment/WeaponRanged/ChargeRifle</texPath>
      <graphicClass>Graphic_Single</graphicClass>
      <drawSize>(2,2)</drawSize>
    </graphicData>
    <soundInteract>Interact_Rifle</soundInteract>
    <menuHidden>true</menuHidden>
    <destroyOnDrop>true</destroyOnDrop>
    <tradeability>None</tradeability>
    <useHitPoints>false</useHitPoints>
    <statBases>
      <AccuracyTouch>0.25</AccuracyTouch>
      <AccuracyShort>0.65</AccuracyShort>
      <AccuracyMedium>0.60</AccuracyMedium>
      <AccuracyLong>0.45</AccuracyLong>
      <RangedWeapon_Cooldown>3.5</RangedWeapon_Cooldown>
      <DeteriorationRate>0</DeteriorationRate>
      <Mass>40</Mass>
      <Flammability>0</Flammability>
    </statBases>
    <weaponTags Inherit="false">
      <li>TurretGun</li>
    </weaponTags>
    <verbs>
      <li>
        <verbClass>Verb_Shoot</verbClass>
        <hasStandardCommand>true</hasStandardCommand>
        <defaultProjectile>Bullet_AutocannonTurret</defaultProjectile>
        <warmupTime>0</warmupTime>
        <minRange>8.9</minRange>
        <range>32.9</range>
        <ticksBetweenBurstShots>17</ticksBetweenBurstShots>
        <burstShotCount>3</burstShotCount>
        <soundCast>Shot_Autocannon</soundCast>
        <soundCastTail>GunTail_Heavy</soundCastTail>
        <muzzleFlashScale>12</muzzleFlashScale>
        <consumeFuelPerShot>1</consumeFuelPerShot>
      </li>
    </verbs>
  </ThingDef>

  <!--=============== Sniper turret ===============-->

  <ThingDef ParentName="AutocannonTurret">
    <defName>Turret_Sniper</defName>
    <label>uranium slug turret</label>
    <description>A long-ranged armor-piercing turret. Its ultra-dense uranium shells can punch through heavy armor at long ranges, but it requires new uranium slugs to be loaded after use. It's more accurate at longer ranges, and can't fire at all close up. May explode when damaged.</description>
    <uiIconPath>Things/Building/Security/TurretSniper_MenuIcon</uiIconPath>
    <statBases>
      <ShootingAccuracyTurret>0.988</ShootingAccuracyTurret>
    </statBases>
    <costList Inherit="False">
      <Steel>300</Steel>
      <Plasteel>30</Plasteel>
      <Uranium>60</Uranium>
      <ComponentIndustrial>6</ComponentIndustrial>
    </costList>
    <comps Inherit="False">
      <li Class="CompProperties_Explosive">
        <explosiveRadius>5.9</explosiveRadius>
        <explosiveDamageType>Bomb</explosiveDamageType>
        <chanceNeverExplodeFromDamage>0.5</chanceNeverExplodeFromDamage>
      </li>
      <li Class="CompProperties_Forbiddable"/>
      <li Class="CompProperties_Power">
        <compClass>CompPowerTrader</compClass>
        <basePowerConsumption>150</basePowerConsumption>
      </li>
      <li Class="CompProperties_Flickable"/>
      <li Class="CompProperties_Breakdownable"/>
      <li Class="CompProperties_Refuelable">
        <fuelLabel>Shots until rearm</fuelLabel>
        <fuelGizmoLabel>Barrel durability</fuelGizmoLabel>
        <fuelFilter>
          <thingDefs>
            <li>Uranium</li>
          </thingDefs>
        </fuelFilter>
        <fuelCapacity>40</fuelCapacity>
        <initialFuelPercent>1</initialFuelPercent>
        <autoRefuelPercent>0.75</autoRefuelPercent>
        <showFuelGizmo>true</showFuelGizmo>
        <minimumFueledThreshold>1</minimumFueledThreshold>
        <fuelMultiplier>0.667</fuelMultiplier>
        <factorByDifficulty>true</factorByDifficulty>
        <consumeFuelOnlyWhenUsed>true</consumeFuelOnlyWhenUsed>
        <outOfFuelMessage>Cannot shoot: Needs rearm</outOfFuelMessage>
        <fuelIconPath>UI/Overlays/Barrel</fuelIconPath>
      </li>
    </comps>
    <specialDisplayRadius>49.9</specialDisplayRadius>
    <building>
      <turretGunDef>Gun_TurretSniper</turretGunDef>
      <turretBurstCooldownTime>3.2</turretBurstCooldownTime>
      <turretTopGraphicPath>Things/Building/Security/TurretSniper_Top</turretTopGraphicPath>
    </building>
    <placeWorkers>
      <li>PlaceWorker_TurretTop</li>
    </placeWorkers>
    <researchPrerequisites>
      <li>SniperTurret</li>
    </researchPrerequisites>
  </ThingDef>

  <ThingDef ParentName="BaseBullet">
    <defName>Bullet_TurretSniper</defName>
    <label>uranium slug</label>
    <graphicData>
      <texPath>Things/Projectile/Bullet_Big</texPath>
      <graphicClass>Graphic_Single</graphicClass>
      <drawSize>1.4</drawSize>
    </graphicData>
    <projectile>
      <damageDef>Bullet</damageDef>
      <damageAmountBase>75</damageAmountBase>
      <speed>120</speed>
    </projectile>
  </ThingDef>

  <ThingDef ParentName="BaseHumanGun">
    <defName>Gun_TurretSniper</defName>
    <label>uranium slug cannon</label>
    <description>A self-loading sniper cannon designed to attach to a turret. Precise at range, it's not good at tracking close targets.</description>
    <graphicData>
      <texPath>Things/Item/Equipment/WeaponRanged/ChargeRifle</texPath>
      <graphicClass>Graphic_Single</graphicClass>
      <drawSize>(2,2)</drawSize>
    </graphicData>
    <soundInteract>Interact_Rifle</soundInteract>
    <menuHidden>true</menuHidden>
    <destroyOnDrop>true</destroyOnDrop>
    <tradeability>None</tradeability>
    <useHitPoints>false</useHitPoints>
    <statBases>
      <AccuracyTouch>0.20</AccuracyTouch>
      <AccuracyShort>0.30</AccuracyShort>
      <AccuracyMedium>0.40</AccuracyMedium>
      <AccuracyLong>0.99</AccuracyLong>
      <RangedWeapon_Cooldown>4.0</RangedWeapon_Cooldown>
      <DeteriorationRate>0</DeteriorationRate>
      <Mass>40</Mass>
      <Flammability>0</Flammability>
    </statBases>
    <weaponTags Inherit="false">
      <li>TurretGun</li>
    </weaponTags>
    <verbs>
      <li>
        <verbClass>Verb_Shoot</verbClass>
        <hasStandardCommand>true</hasStandardCommand>
        <defaultProjectile>Bullet_TurretSniper</defaultProjectile>
        <warmupTime>0</warmupTime>
        <minRange>11.9</minRange>
        <range>49.9</range>
        <burstShotCount>1</burstShotCount>
        <soundCast>Shot_TurretSniper</soundCast>
        <soundCastTail>GunTail_Heavy</soundCastTail>
        <muzzleFlashScale>18</muzzleFlashScale>
        <consumeFuelPerShot>1</consumeFuelPerShot>
      </li>
    </verbs>
  </ThingDef>

  <!-- ================ Mortars ==================-->

  <ThingDef Name="BaseArtilleryBuilding" ParentName="BuildingBase" Abstract="True">
    <thingClass>Building_TurretGun</thingClass>
    <graphicData>
      <texPath>Things/Building/Security/TurretMortar_Base</texPath>
      <graphicClass>Graphic_Single</graphicClass>
      <drawSize>(4,4)</drawSize>
      <damageData>
        <rect>(0.38,0.2,0.56375,0.8)</rect>
        <cornerTL>Damage/Corner</cornerTL>
      </damageData>
      <shadowData>
	      <offset>(-0.13,-0.87,-0.1)</offset>
        <volume>(0.5,0.4,1.05)</volume>
      </shadowData>
    </graphicData>
    <minifiedDef>MinifiedThing</minifiedDef>
    <altitudeLayer>Building</altitudeLayer>
    <hasInteractionCell>True</hasInteractionCell>
    <interactionCellOffset>(0,0,-1)</interactionCellOffset>
    <stealable>false</stealable>
    <size>(2,2)</size>
    <passability>PassThroughOnly</passability>
    <pathCost>50</pathCost>
    <fillPercent>0.4</fillPercent>
    <thingCategories>
      <li>BuildingsSecurity</li>
    </thingCategories>
    <stuffCategories>
      <li>Metallic</li>
    </stuffCategories>
    <tickerType>Normal</tickerType>
    <terrainAffordanceNeeded>Light</terrainAffordanceNeeded>
    <designationCategory>Security</designationCategory>
		<costStuffCount>50</costStuffCount>
    <constructionSkillPrerequisite>5</constructionSkillPrerequisite>
    <costList>
			<Steel>100</Steel>
			<ComponentIndustrial>4</ComponentIndustrial>
		</costList>
    <inspectorTabs>
      <li>ITab_Shells</li>
    </inspectorTabs>
    <comps>
      <li Class="CompProperties_Forbiddable"/>
      <li Class="CompProperties_Mannable">
        <manWorkType>Violent</manWorkType>
      </li>
    </comps>
    <statBases>
      <MaxHitPoints>180</MaxHitPoints>
      <Flammability>0.7</Flammability>
      <WorkToBuild>1000</WorkToBuild>
      <Mass>30</Mass>
      <Beauty>-20</Beauty>
    </statBases>
    <building>
      <turretBurstWarmupTime>4.0</turretBurstWarmupTime>
			<turretBurstCooldownTime>28.0</turretBurstCooldownTime>
			<buildingTags>
				<li>Artillery</li>
			</buildingTags>
		</building>
    <placeWorkers>
      <li>PlaceWorker_NotUnderRoof</li>
      <li>PlaceWorker_TurretTop</li>
    </placeWorkers>
    <researchPrerequisites>
      <li>Mortars</li>
    </researchPrerequisites>
    <uiIconScale>1.1</uiIconScale>
  </ThingDef>

  <ThingDef Name="BaseArtilleryWeapon" Abstract="True">
    <category>Item</category>
    <thingClass>ThingWithComps</thingClass>
    <label>artillery error</label>
    <useHitPoints>false</useHitPoints>
    <equipmentType>Primary</equipmentType>
    <tickerType>Never</tickerType>
    <techLevel>Industrial</techLevel>
    <destroyOnDrop>True</destroyOnDrop>
    <menuHidden>True</menuHidden>
    <tradeability>None</tradeability>
    <weaponTags>
      <li>Artillery</li>
    </weaponTags>
    <comps>
      <li>
        <compClass>CompEquippable</compClass>
      </li>
      <li Class="CompProperties_ChangeableProjectile" />
    </comps>
    <building>
      <fixedStorageSettings>
        <filter>
          <categories>
            <li>MortarShells</li>
          </categories>
        </filter>
      </fixedStorageSettings>
      <defaultStorageSettings>
        <filter>
          <categories>
            <li>MortarShells</li>
          </categories>
          <disallowedThingDefs>
            <li>Shell_Firefoam</li>
            <li>Shell_AntigrainWarhead</li>
          </disallowedThingDefs>
        </filter>
      </defaultStorageSettings>
    </building>
  </ThingDef>

  <!--=============== Mortar turret ===============-->

  <ThingDef ParentName="BaseArtilleryBuilding">
    <defName>Turret_Mortar</defName>
    <label>mortar</label>
    <description>A manned mortar that launches all kinds of shells. While it can inflict devastating damage, the mortar's inherent inaccuracy makes it more useful for attacking large fortifications than groups of enemies in the field.</description>
    <comps>
      <li Class="CompProperties_Explosive">
        <explosiveRadius>4.9</explosiveRadius>
        <explosiveDamageType>Bomb</explosiveDamageType>
      </li>
    </comps>
    <designationHotKey>Misc4</designationHotKey>
    <terrainAffordanceNeeded>Heavy</terrainAffordanceNeeded>
    <building>
      <turretGunDef>Artillery_Mortar</turretGunDef>
      <turretTopGraphicPath>Things/Building/Security/TurretMortar_Top</turretTopGraphicPath>
      <buildingTags>
        <li>Artillery_BaseDestroyer</li>
      </buildingTags>
    </building>
	<uiIconPath>Things/Building/Security/TurretMortar_MenuIcon</uiIconPath>
	<uiIconScale>0.9</uiIconScale>
  </ThingDef>
  
  <ThingDef ParentName="BaseArtilleryWeapon">
    <defName>Artillery_Mortar</defName>
    <label>mortar</label>
    <description>Mortar launcher. Lobs bombs over walls. Very inaccurate but long-ranged.</description>
    <weaponTags>
      <li>Artillery_BaseDestroyer</li>
    </weaponTags>
    <verbs>
      <li>
        <verbClass>Verb_Shoot</verbClass>
        <forceNormalTimeSpeed>false</forceNormalTimeSpeed>
        <hasStandardCommand>true</hasStandardCommand>
        <warmupTime>4.0</warmupTime>
        <forcedMissRadius>13</forcedMissRadius>
        <requireLineOfSight>false</requireLineOfSight>
        <minRange>29.9</minRange>
        <range>500</range>
        <burstShotCount>1</burstShotCount>
        <soundCast>Mortar_LaunchA</soundCast>
        <muzzleFlashScale>16</muzzleFlashScale>
        <targetParams>
          <canTargetLocations>true</canTargetLocations>
        </targetParams>
      </li>
    </verbs>
  </ThingDef>

  <!--==================== Traps ======================== -->

  <ThingDef ParentName="BuildingBase">
    <defName>TrapSpike</defName>
    <label>spike trap</label>
    <description>Five spikes under tension, connected to a touch-activated trigger. When the victim disturbs the trigger, the spikes spring forthm and strike the victim. Since it is hidden in the surrounding terrain, it cannot be placed adjacent to other traps. Animals can sense these when calm.</description>
    <thingClass>Building_TrapDamager</thingClass>
    <graphicData>
      <texPath>Things/Building/Security/TrapSpikeArmed</texPath>
      <graphicClass>Graphic_Single</graphicClass>
      <damageData>
        <rect>(0,0,1,0.15)</rect>
      </damageData>
    </graphicData>
    <altitudeLayer>Building</altitudeLayer>
    <drawerType>RealtimeOnly</drawerType>
    <rotatable>false</rotatable>
    <tickerType>Normal</tickerType>
    <stealable>false</stealable>
    <minifiedDef>MinifiedThing</minifiedDef>
    <thingCategories>
      <li>BuildingsSecurity</li>
    </thingCategories>
    <statBases>
      <Mass>2.5</Mass>
      <MaxHitPoints>40</MaxHitPoints>
      <WorkToBuild>1800</WorkToBuild>
      <Flammability>1</Flammability>
      <Beauty>-18</Beauty>
      <Cleanliness>-5</Cleanliness>
      <TrapMeleeDamage>100</TrapMeleeDamage>
      <TrapSpringChance>1.0</TrapSpringChance>
    </statBases>
    <stuffCategories>
      <li>Metallic</li>
      <li>Woody</li>
      <li>Stony</li>
    </stuffCategories>
    <costStuffCount>35</costStuffCount>
    <designationCategory>Security</designationCategory>
    <designationHotKey>Misc6</designationHotKey>
    <building>
      <isTrap>true</isTrap>
      <trapDestroyOnSpring>true</trapDestroyOnSpring>
      <trapDamageCategory>Sharp</trapDamageCategory>
      <expandHomeArea>false</expandHomeArea>
			<ai_chillDestination>false</ai_chillDestination>
    </building>
    <constructionSkillPrerequisite>3</constructionSkillPrerequisite>
    <placeWorkers>
      <li>PlaceWorker_NeverAdjacentTrap</li>
    </placeWorkers>
  </ThingDef>

  <ThingDef Name="TrapIEDBase" ParentName="BuildingBase" Abstract="True">
    <thingClass>Building_TrapExplosive</thingClass>
    <graphicData>
      <graphicClass>Graphic_Single</graphicClass>
      <damageData>
        <rect>(0.1,0,0.8,0.3)</rect>
      </damageData>
    </graphicData>
    <uiIconOffset>(0,-0.14)</uiIconOffset>
    <altitudeLayer>Building</altitudeLayer>
    <drawerType>RealtimeOnly</drawerType>
    <rotatable>false</rotatable>
    <tickerType>Normal</tickerType>
    <stealable>false</stealable>
    <minifiedDef>MinifiedThing</minifiedDef>
    <thingCategories>
      <li>BuildingsSecurity</li>
    </thingCategories>
    <statBases>
      <Mass>2</Mass>
      <MaxHitPoints>40</MaxHitPoints>
      <WorkToBuild>800</WorkToBuild>
      <Flammability>1</Flammability>
      <Beauty>-4</Beauty>
      <TrapSpringChance>1.0</TrapSpringChance>
    </statBases>
    <designationCategory>Security</designationCategory>
    <building>
      <isTrap>true</isTrap>
      <trapPeacefulWildAnimalsSpringChanceFactor>0.25</trapPeacefulWildAnimalsSpringChanceFactor>
      <expandHomeArea>false</expandHomeArea>
			<ai_chillDestination>false</ai_chillDestination>
    </building>
    <constructionSkillPrerequisite>3</constructionSkillPrerequisite>
    <researchPrerequisites>
      <li>IEDs</li>
    </researchPrerequisites>
    <placeWorkers>
      <li>PlaceWorker_NeverAdjacentTrap</li>
    </placeWorkers>
  </ThingDef>

  <ThingDef ParentName="TrapIEDBase">
    <defName>TrapIED_HighExplosive</defName>
    <label>IED trap</label>
    <description>A pair of high-explosive shells connected to a touch-activated trigger. Since it is hidden in the surrounding terrain, it cannot be placed adjacent to other traps. Animals can sense these when calm.</description>
    <graphicData>
      <texPath>Things/Building/Security/IEDHighExplosive</texPath>
    </graphicData>
    <costList>
      <Shell_HighExplosive>2</Shell_HighExplosive>
    </costList>
    <designationHotKey>Misc7</designationHotKey>
    <comps>
      <li Class="CompProperties_Explosive">
        <explosiveRadius>3.9</explosiveRadius>
        <explosiveDamageType>Bomb</explosiveDamageType>
        <startWickHitPointsPercent>0.2</startWickHitPointsPercent>
        <wickTicks>
          <min>15</min>
          <max>15</max>
        </wickTicks>
      </li>
    </comps>
    <specialDisplayRadius>3.9</specialDisplayRadius>
  </ThingDef>

  <ThingDef ParentName="TrapIEDBase">
    <defName>TrapIED_Incendiary</defName>
    <label>IED incendiary trap</label>
    <description>A pair of incendiary shells connected to a touch-activated trigger. Since it is hidden in the surrounding terrain, it cannot be placed adjacent to other traps. Animals can sense these when calm.</description>
    <graphicData>
      <texPath>Things/Building/Security/IEDIncendiary</texPath>
    </graphicData>
    <costList>
      <Shell_Incendiary>2</Shell_Incendiary>
    </costList>
    <designationHotKey>Misc8</designationHotKey>
    <comps>
      <li Class="CompProperties_Explosive">
        <explosiveRadius>3.9</explosiveRadius>
        <explosiveDamageType>Flame</explosiveDamageType>
        <startWickHitPointsPercent>0.2</startWickHitPointsPercent>
        <wickTicks>
          <min>15</min>
          <max>15</max>
        </wickTicks>
      </li>
    </comps>
    <specialDisplayRadius>3.9</specialDisplayRadius>
  </ThingDef>

  <ThingDef ParentName="TrapIEDBase">
    <defName>TrapIED_EMP</defName>
    <label>IED EMP trap</label>
    <description>A pair of EMP shells connected to a touch-activated trigger. The explosion can paralyze mechanoids for a few seconds. Since it is hidden in the surrounding terrain, it cannot be placed adjacent to other traps. Animals can sense these when calm.</description>
    <graphicData>
      <texPath>Things/Building/Security/IEDEMP</texPath>
    </graphicData>
    <costList>
      <Shell_EMP>2</Shell_EMP>
    </costList>
    <designationHotKey>Misc9</designationHotKey>
    <comps>
      <li Class="CompProperties_Explosive">
        <explosiveRadius>10.9</explosiveRadius>
        <explosiveDamageType>EMP</explosiveDamageType>
        <startWickHitPointsPercent>0.2</startWickHitPointsPercent>
        <wickTicks>
          <min>15</min>
          <max>15</max>
        </wickTicks>
      </li>
    </comps>
    <specialDisplayRadius>10.9</specialDisplayRadius>
  </ThingDef>

  <ThingDef ParentName="TrapIEDBase">
    <defName>TrapIED_Firefoam</defName>
    <label>IED firefoam trap</label>
    <description>A pair of firefoam shells connected to a touch-activated trigger. Since it is hidden in the surrounding terrain, it cannot be placed adjacent to other traps. Animals can sense these when calm.</description>
    <graphicData>
      <texPath>Things/Building/Security/IEDFirefoam</texPath>
    </graphicData>
    <costList>
      <Shell_Firefoam>2</Shell_Firefoam>
    </costList>
    <designationHotKey>Misc10</designationHotKey>
    <comps>
      <li Class="CompProperties_Explosive">
        <explosiveRadius>9.9</explosiveRadius>
        <explosiveDamageType>Extinguish</explosiveDamageType>
        <startWickHitPointsPercent>0.2</startWickHitPointsPercent>
        <postExplosionSpawnThingDef>Filth_FireFoam</postExplosionSpawnThingDef>
        <postExplosionSpawnChance>1</postExplosionSpawnChance>
        <postExplosionSpawnThingCount>3</postExplosionSpawnThingCount>
        <applyDamageToExplosionCellsNeighbors>true</applyDamageToExplosionCellsNeighbors>
        <explosionEffect>ExtinguisherExplosion</explosionEffect>
        <wickTicks>
          <min>15</min>
          <max>15</max>
        </wickTicks>
      </li>
    </comps>
    <specialDisplayRadius>6.9</specialDisplayRadius>
  </ThingDef>

  <ThingDef ParentName="TrapIEDBase">
    <defName>TrapIED_AntigrainWarhead</defName>
    <label>IED antigrain warhead trap</label>
    <description>An antimatter-powered antigrain warhead connected to a touch-activated trigger. Since it is hidden in the surrounding terrain, it cannot be placed adjacent to other traps. Animals can sense these when calm.</description>
    <graphicData>
      <texPath>Things/Building/Security/IEDAntigrainWarhead</texPath>
    </graphicData>
    <costList>
      <Shell_AntigrainWarhead>1</Shell_AntigrainWarhead>
    </costList>
    <designationHotKey>Misc11</designationHotKey>
    <comps>
      <li Class="CompProperties_Explosive">
        <explosiveRadius>14.9</explosiveRadius>
        <explosiveDamageType>BombSuper</explosiveDamageType>
        <startWickHitPointsPercent>0.2</startWickHitPointsPercent>
        <chanceToStartFire>0.22</chanceToStartFire>
        <damageFalloff>true</damageFalloff>
        <explosionEffect>GiantExplosion</explosionEffect>
        <explosionSound>Explosion_GiantBomb</explosionSound>
        <wickTicks>
          <min>15</min>
          <max>15</max>
        </wickTicks>
      </li>
    </comps>
    <specialDisplayRadius>14.9</specialDisplayRadius>
  </ThingDef>

</Defs>
